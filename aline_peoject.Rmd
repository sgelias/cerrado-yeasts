---
title: "R Notebook"
output: html_notebook
---

# Experimento 1 - Biocontrole fúngico


## Carrega os pacotes necessários
```{r}
# install.packages('ggplot2', dependencies = T)
# install.packages('userfriendlyscience')
require(ggplot2)
require(userfriendlyscience)
```



## Passo 1 - Carrega e visualiza os dados
```{r}
data1 <- read.csv("Biocontrole.csv", row.names = 1)
data1
```


## Passo 2 - Análise exploratória dos dados


### Plota um histograma para verificar a distribuição possível dos dados
```{r}
hist1 <- ggplot(data1, aes(data1$growth)) +
  geom_histogram(aes(y = ..density..), bins = 20) +
  labs(x = "Crescimento (cm)", y = "Frequência") +
  geom_density(col = 'red')


ggsave(
  plot = hist1,
  filename = "Figures/Experimento_1/Histograma1.svg",
  #height = 5,
  width = 15
)


hist1
```


### Verifica o ajuste à normalidade univariada e homogeneidade das variâncias
```{r}
# Normalidade univariada
shapiro.test(data1$growth)

# Homogeneidade das variâncias
bartlett.test(growth ~ group, data = data1)
```


### Verifica quantos registros sobrarão caso os valores maiores que 8.5 sejam removidos
```{r}

print(
  paste0(
   'Tamanh total da matriz: ',
   dim(data1)[1] 
  )
)

print(
  paste0(
   'Número de registos a serem removidos: ',
   dim(data1[data1$growth > 8.5, ])[1] 
  )
)

print(
  paste0(
   'Tamanho da matriz após a remoção dos registros maiores que 8.5: ',
   dim(data1[data1$growth < 8.5, ])[1] 
  )
)

```


### Remove valores maiores que 8.5 cm
```{r}
data1.1 <- data1[data1$growth < 8.5, ]
data1.1
```


### Re-plota o histograma
```{r}
hist2 <- ggplot(data1.1, aes(data1.1$growth)) +
  geom_histogram(aes(y = ..density..), bins = 20) +
  labs(x = "Crescimento (cm)", y = "Frequência") +
  geom_density(col = 'red')


ggsave(
  plot = hist2,
  filename = "Figures/Experimento_1/Histograma1.svg",
  #height = 5,
  width = 15
)


hist2
```


### Verifica o ajuste à distribuição normal
```{r}
# Normalidade univariada
shapiro.test(data1.1$growth)

# Homogeneidade das variâncias
bartlett.test(growth ~ group, data = data1.1)
```


### Análise de variância
```{r}
lnModel <- oneway(
  y = ChickWeight$weight,
  x = ChickWeight$Diet,
  posthoc = 'games-howell',
  posthocLetters = TRUE
)
```


### Plota os dados do experimento 1
```{r}
gp_box <- ggplot(data1.1, aes(x = reorder(group, -growth, median), y = growth)) +
  
  # Graph type
  geom_boxplot() +
  
  # Labels
  labs(x = "Isolado", y = "Crescimento (cm)") +
  
  # Theme labels position
  theme(axis.text.x = element_text(angle = 90)) +
  
  # Annotations
  geom_text(
    aes(label = y, y = y + 0.05),
    position = position_dodge(0.9),
    vjust = 0
  )


ggsave(
  plot = gp_box,
  filename = "Figures/Experimento_1/Boxplot.svg",
  #height = 5,
  width = 15
)


gp_box
```


