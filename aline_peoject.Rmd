---
title: "Experimento 1 - Biocontrole Fúngico"
output:
  html_document:
    df_print: paged
    toc: true
    toc_depth: 3
---


## Carrega os pacotes necessários
```{r}

# install.packages('ggplot2', dependencies = T)
# install.packages('svglite', dependencies = T)
require(ggplot2)
require(svglite)
require(agricolae)
library(ggridges)

```


Passos para realização da análise dos dados:
1 - Realizar análises exploratórias para verificar o comportamento da variável a ser analisada;
2 - Nesse passo são realizadas as análises própriamente ditas.


## Carregar os dados
```{r}

data1 <- read.csv("Biocontrole.csv", row.names = 1)
data1

```


## Passo 1 - Realizar uma análise exploratória dos dados


### Plotar um histograma para verificar a distribuição possível dos dados
```{r}

hist1 <- ggplot(data1, aes(data1$growth)) +
  geom_histogram(aes(y = ..density..), bins = 20) +
  labs(x = "Crescimento (cm)", y = "Frequência") +
  geom_density(col = 'red')


ggsave(
  plot = hist1,
  filename = "Figures/Experimento_1/Histograma1.svg",
  #height = 5,
  width = 8
)


hist1

```


### Verificar o ajuste à normalidade univariada e homogeneidade das variâncias
```{r}

# Normalidade univariada
shapiro.test(data1$growth)

# Homogeneidade das variâncias
bartlett.test(growth ~ group, data = data1)

```


## Passo 2 - Nesse passo será utilizada a análise de variância, considerando que a hipótese de não normalidade dos dados foi aceita (vide teste de Shapiro-Wilk), será utilizado o logarítmo na base dez do crescimento micelial como variável resposta.


### Roda a análise de variância
```{r}

lmModel <- aov(
  log10(growth) ~ group,
  data = data1
)

lmModel

```


### Testa a normalidade univariada dos resíduos
```{r}

# Normalidade univariada dos resíduos
shapiro.test(lmModel$residuals)

```


### Gera o teste de multiplicidade
```{r}

hsd_pair <- HSD.test(lmModel, "group", group = T)

```



### Gera um histograma com os resíduos gerados na análise de variância
```{r}

res <- data.frame(
  cbind(
    lmModel$residuals,
    lmModel$model 
  )
)


hist2 <- ggplot(res, aes(res$lmModel.residuals)) +
  geom_histogram(aes(y = ..density..), bins = 20) +
  labs(x = "Crescimento (cm)", y = "Frequência") +
  geom_density(col = 'red')


ggsave(
  plot = hist2,
  filename = "Figures/Experimento_1/Histograma2.svg",
  width = 8
)


hist2

```


### Plota o boxplot com os dados do experimento 1
```{r fig.width=8, fig.height=10}

stat_labels = hsd_pair$groups

stat_labels$labels = paste0(stat_labels$groups, " (", round(stat_labels$`log10(growth)` * 10, digits = 2), ")")

gp_box <- ggplot(data1, aes(x = reorder(group, growth, median), y = growth)) +
  
  # Graph type
  geom_boxplot(width = 0.5) +
  
  scale_fill_manual(values = 'white') +
  
  scale_color_manual(values = 'grey70') +
  
  # Labels
  labs(x = "Isolado", y = "Crescimento (cm)") +
  
  # Theme labels position
  theme() +
  
  # Include text
  geom_text(
    data = hsd_pair$groups,
    mapping = aes(
      x = rownames(hsd_pair$groups), 
      y = 2, 
      label = stat_labels$groups
    ),
    hjust = 0
  ) +
  
  geom_hline(yintercept = 6, linetype = "dashed", color = "grey50") +
  
  # Rotate right
  coord_flip()


ggsave(
  plot = gp_box,
  filename = "Figures/Experimento_1/Boxplot.svg",
  height = 10,
  width = 8
)


gp_box

```

